package io.ergodex.core

import io.ergodex.core.lqmining.simple.LqMiningPoolBoxSelfHosted
import org.ergoplatform.ErgoLikeTransaction

object DebugContract extends App with LedgerPlatform {
  val json =
    """
      |{"id":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","inputs":[{"boxId":"e8cb8e8acbebab6b9ba3706904facd70393f5731c7e36a55caa660fde5419b60","spendingProof":{"proofBytes":"","extension":{}}},{"boxId":"33f07928fd670e1d091c3b7dcf61f2b385bce681197857712a314215471b0a21","spendingProof":{"proofBytes":"1d7b209d7ded3438571efb23cd04f8ed938de5d6125ba42a119d6f84997f3f52dec6e4a056ecd91a2a629a724ebd11c81b65808c4ba40cab","extension":{}}},{"boxId":"3f59486745f97ceeac069cc003aa59ff41faedf949c0e9f8408cbe0e6063c4c5","spendingProof":{"proofBytes":"","extension":{"0":"0408","1":"0404"}}},{"boxId":"68e0413ae6ca3cf686ae292e95a716c6ecfac61b8a22dc53ee671ca7da5c79ff","spendingProof":{"proofBytes":"","extension":{"0":"0408","1":"0404"}}}],"dataInputs":[],"outputs":[{"boxId":"60835ee6b477f0afb46bf339d874fcd2f2a9a47140e5922122599e4ea09918af","value":1250000,"ergoTree":"19e9041f04000402040204040404040604060408040804040402040004000402040204000400040a0500040204020500050004020402040605000500040205000500d81bd601b2a5730000d602db63087201d603db6308a7d604e4c6a70410d605e4c6a70505d606e4c6a70605d607b27202730100d608b27203730200d609b27202730300d60ab27203730400d60bb27202730500d60cb27203730600d60db27202730700d60eb27203730800d60f8c720a02d610998c720902720fd6118c720802d612b27204730900d6139a99a37212730ad614b27204730b00d6159d72137214d61695919e72137214730c9a7215730d7215d617b27204730e00d6187e721705d6199d72057218d61a998c720b028c720c02d61b998c720d028c720e02d1ededededed93b27202730f00b27203731000ededed93e4c672010410720493e4c672010505720593e4c6720106057206928cc77201018cc7a70193c27201c2a7ededed938c7207018c720801938c7209018c720a01938c720b018c720c01938c720d018c720e0193b172027311959172107312eded929a997205721172069c7e9995907216721772169a721773137314057219937210f0721a939c7210997218a273157e721605f0721b958f72107316ededec929a997205721172069c7e9995907216721772169a72177317731805721992a39a9a72129c72177214b2720473190093721af0721092721b959172167217731a9c721a997218a2731b7e721605d801d61ce4c672010704edededed90721c997216731c909972119c7e997217721c0572199a7219720693f0998c72070272117d9d9c7e7219067e721b067e720f0605937210731d93721a731e","assets":[{"tokenId":"5c7b7988f34bfb13059c447c648c23c36d121228588fa9ea68b9943b0333ea4c","amount":1},{"tokenId":"0779ec04f2fae64e87418a1ad917639d4668f78484f45df962b0dec14a2591d2","amount":9323},{"tokenId":"98da76cecb772029cfec3d53727d5ff37d5875691825fbba743464af0c89ce45","amount":311},{"tokenId":"3fdce3da8d364f13bca60998c20660c79c19923f44e141df01349d2e63651e86","amount":9999789},{"tokenId":"c256908dd9fd477bde350be6a41c0884713a1b1d589357ae731763455ef28c10","amount":99997101}],"additionalRegisters":{"R6":"05d00f","R7":"0402","R4":"1004d00f1492d66fd00f","R5":"05a09c01"},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":0},{"boxId":"e4d2843847d2ae518690e8b9ca05dd50bd5765d273d020917333189fa49b4e9b","value":9999500000,"ergoTree":"0008cd03b0b2ce2839747f5e4d3c304a0dd67b47f29649a48e19c5cbb7b93aad106911df","assets":[],"additionalRegisters":{},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":1},{"boxId":"0284037979ad0e4ab29768827ff0601dfee8d92623030fa83762ce54908695fa","value":250000,"ergoTree":"19b20315040004000404040404040402040004000500040204020400050204040400040205000404040005fcffffffffffffffff010100d80ed601b2a5730000d602db63087201d603e4c6a7050ed604b2a4730100d605db63087204d6068cb2720573020002d607998cb27202730300027206d608e4c6a7040ed609db6308a7d60a8cb2720973040001d60bb27209730500d60cb27209730600d60d8c720c02d60e8c720b02d1ed938cb27202730700017203959372077308d808d60fb2a5e4e3000400d610b2a5e4e3010400d611db63087210d612b27211730900d613b2e4c672040410730a00d614c672010804d6157e99721395e67214e47214e4c67201070405d616b2db6308720f730b00eded93c2720f7208edededededed93e4c67210040e720893e4c67210050e720393c27210c2a7938602720a730cb27211730d00938c7212018c720b019399720e8c72120299720e9c7215720d93b27211730e00720ced938c7216018cb27205730f0001927e8c721602069d9c9c7e9de4c6720405057e721305067e720d067e999d720e720d7215067e720606958f7207731093b2db6308b2a47311007312008602720a73137314","assets":[{"tokenId":"3fdce3da8d364f13bca60998c20660c79c19923f44e141df01349d2e63651e86","amount":102},{"tokenId":"c256908dd9fd477bde350be6a41c0884713a1b1d589357ae731763455ef28c10","amount":918},{"tokenId":"1f6bc0b7c1b89a42ce8b80330d49bf4fb1cd06a85ec74d60c1d8e8e05a21a42d","amount":1}],"additionalRegisters":{"R5":"0e205c7b7988f34bfb13059c447c648c23c36d121228588fa9ea68b9943b0333ea4c","R4":"0e240008cd03b196b978d77488fba3138876a40a40b9a046c2fbb5ecfa13d4ecf8f1eec52aec"},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":2},{"boxId":"a1fac1cbac781c4486852654eaf10241cfe3c78d7ff6f9e8f433b60a438de16b","value":250000,"ergoTree":"19b20315040004000404040404040402040004000500040204020400050204040400040205000404040005fcffffffffffffffff010100d80ed601b2a5730000d602db63087201d603e4c6a7050ed604b2a4730100d605db63087204d6068cb2720573020002d607998cb27202730300027206d608e4c6a7040ed609db6308a7d60a8cb2720973040001d60bb27209730500d60cb27209730600d60d8c720c02d60e8c720b02d1ed938cb27202730700017203959372077308d808d60fb2a5e4e3000400d610b2a5e4e3010400d611db63087210d612b27211730900d613b2e4c672040410730a00d614c672010804d6157e99721395e67214e47214e4c67201070405d616b2db6308720f730b00eded93c2720f7208edededededed93e4c67210040e720893e4c67210050e720393c27210c2a7938602720a730cb27211730d00938c7212018c720b019399720e8c72120299720e9c7215720d93b27211730e00720ced938c7216018cb27205730f0001927e8c721602069d9c9c7e9de4c6720405057e721305067e720d067e999d720e720d7215067e720606958f7207731093b2db6308b2a47311007312008602720a73137314","assets":[{"tokenId":"3fdce3da8d364f13bca60998c20660c79c19923f44e141df01349d2e63651e86","amount":109},{"tokenId":"c256908dd9fd477bde350be6a41c0884713a1b1d589357ae731763455ef28c10","amount":981},{"tokenId":"6a928dad5999caeaf08396f9a40c37b1b09ce2b972df457f4afacb61ff69009a","amount":1}],"additionalRegisters":{"R4":"0e240008cd03b196b978d77488fba3138876a40a40b9a046c2fbb5ecfa13d4ecf8f1eec52aec","R5":"0e205c7b7988f34bfb13059c447c648c23c36d121228588fa9ea68b9943b0333ea4c"},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":3},{"boxId":"a1260d7c6cd26049e9c458c7df10c5354113842bc6a3304ee2806ddcfbc858eb","value":250000,"ergoTree":"0008cd03b196b978d77488fba3138876a40a40b9a046c2fbb5ecfa13d4ecf8f1eec52aec","assets":[{"tokenId":"0779ec04f2fae64e87418a1ad917639d4668f78484f45df962b0dec14a2591d2","amount":327}],"additionalRegisters":{},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":4},{"boxId":"6c7517bbe44fd636aa6d6433c9c68b21174479dc0e7d4cc4525c28de1b9a2d13","value":250000,"ergoTree":"0008cd03b196b978d77488fba3138876a40a40b9a046c2fbb5ecfa13d4ecf8f1eec52aec","assets":[{"tokenId":"0779ec04f2fae64e87418a1ad917639d4668f78484f45df962b0dec14a2591d2","amount":350}],"additionalRegisters":{},"creationHeight":916014,"transactionId":"a3a07b96028f0aed043880c2bc835de773c62ed676ac754ed8bedd443422ffde","index":5}]}
      |""".stripMargin

  val Right(tx) = io.circe.parser.decode[ErgoLikeTransaction](json)

  val (inputs, outputs) = pullIOs(tx)

  val Some(setup) = RuntimeSetup.fromIOs[LqMiningPoolBoxSelfHosted](inputs, outputs, 0, 916014)

  println(setup.run.value)
}
